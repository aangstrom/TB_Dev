{
  "entityType" : "CONVERTER",
  "entity" : {
    "additionalInfo" : {
      "description" : ""
    },
    "configuration" : {
      "scriptLang" : "TBEL",
      "decoder" : null,
      "tbelDecoder" : "// Parse JSON safely\r\nvar json = decodeToJson(payload);\r\nif (json == null) {\r\n  json = {};\r\n}\r\n\r\n// Telemetry object\r\nvar telemetry = {};\r\nvar attributes = {}; // reserved for future\r\n\r\n// ---- CASE: plcData ----\r\n// Example: {\"plcData\":{\"relay1\":1,\"relay2\":1,\"relay3\":1,\"key\":0,\"resetStatus\":0}}\r\nif (json.plcData != null) {\r\n  var p = json.plcData;\r\n\r\n  if (p.inp1        != null) telemetry.inp1        = p.inp1 * 1;\r\n  if (p.relay1      != null) telemetry.relay1      = p.relay1 * 1;\r\n  if (p.relay2      != null) telemetry.relay2      = p.relay2 * 1;\r\n  if (p.relay3      != null) telemetry.relay3      = p.relay3 * 1;\r\n  if (p.key         != null) telemetry.key         = p.key * 1;\r\n  if (p.resetStatus != null) telemetry.resetStatus = p.resetStatus * 1;\r\n}\r\n\r\n// ---- CASE: statoArmadioN ----\r\n// Example: {\"statoArmadio1\":{\"stato1\":0}}\r\nfor (var i = 1; i <= 4; i++) {\r\n  var statoKey = \"statoArmadio\" + i;\r\n  if (json[statoKey] != null) {\r\n    var s = json[statoKey];\r\n    var valKey = \"stato\" + i;\r\n    if (s[valKey] != null) telemetry[statoKey] = s[valKey] * 1;\r\n  }\r\n}\r\n\r\n// ---- CASE: armadioChiusoN ----\r\n// Example: {\"armadioChiuso2\":{\"chiuso2\":107}}\r\nfor (var i = 1; i <= 4; i++) {\r\n  var chiusoKey = \"armadioChiuso\" + i;\r\n  if (json[chiusoKey] != null) {\r\n    var c = json[chiusoKey];\r\n    var valKey = \"chiuso\" + i;\r\n    if (c[valKey] != null) telemetry[chiusoKey] = c[valKey] * 1;\r\n  }\r\n}\r\n\r\n// ---- CASE: armadioApertoN ----\r\n// Example: {\"armadioAperto3\":{\"aperto3\":7}}\r\nfor (var i = 1; i <= 4; i++) {\r\n  var apertoKey = \"armadioAperto\" + i;\r\n  if (json[apertoKey] != null) {\r\n    var a = json[apertoKey];\r\n    var valKey = \"aperto\" + i;\r\n    if (a[valKey] != null) telemetry[apertoKey] = a[valKey] * 1;\r\n  }\r\n}\r\n\r\n// ---- CASE: statoAllarmN ----\r\n// Example: {\"statoAllarm1\":{\"allarm1\":1}}\r\nfor (var i = 1; i <= 4; i++) {\r\n  var alarmKey = \"statoAlarm\" + i;\r\n  if (json[alarmKey] != null) {\r\n    var al = json[alarmKey];\r\n    var valKey = \"alarm\" + i;\r\n    if (al[valKey] != null) telemetry[alarmKey] = al[valKey] * 1;\r\n  }\r\n}\r\n\r\n// ---- Return in ThingsBoard format ----\r\nreturn {\r\n  deviceName: \"lab1 station1\",\r\n  deviceType: \"test\",\r\n  attributes: attributes,\r\n  telemetry: telemetry\r\n};",
      "encoder" : null,
      "tbelEncoder" : null,
      "updateOnlyKeys" : [ "manufacturer" ]
    },
    "converterVersion" : 1,
    "debugMode" : false,
    "debugSettings" : {
      "allEnabled" : false,
      "allEnabledUntil" : 1757409749296,
      "failuresEnabled" : true
    },
    "edgeTemplate" : false,
    "externalId" : null,
    "id" : {
      "entityType" : "CONVERTER",
      "id" : "69613010-8d5c-11f0-bb0f-799059dff0f8"
    },
    "integrationType" : "MQTT",
    "name" : "Uplink data converter for Apertura armadi makros",
    "type" : "UPLINK"
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}