{
  "entityType" : "CONVERTER",
  "entity" : {
    "additionalInfo" : {
      "description" : ""
    },
    "configuration" : {
      "scriptLang" : "TBEL",
      "decoder" : "/** Decoder **/\n\n// decode payload to string\nvar data = decodeToString(payload);\n\n// deviceName\nvar deviceName =  metadata.topic.split(\"/\")[1];\n\n// pattern\nvar patterncar = 'frigate/'+deviceName+'/car';\nvar patternperson = 'frigate/'+deviceName+'/person';\nvar patternbicycle = 'frigate/'+deviceName+'/bicycle';\nvar patterncarsnapshot = 'frigate/'+deviceName+'/car/snapshot';\nvar patternpersonsnapshot = 'frigate/'+deviceName+'/person/snapshot';\nvar patternbicyclesnapshot = 'frigate/'+deviceName+'/bicycle/snapshot';\n\nswitch (metadata.topic) {\n    case patterncar:\n        var car = data;\n        break;\n    case patternperson:\n        var person = data;\n        break;\n    case patternbicycle:\n        var bicycle = data;\n        break;\n    case patterncarsnapshot:\n        var carsnapshot = payload;\n        break;\n    case patternpersonsnapshot:\n        var personsnapshot = payload;\n        break;\n    case patternbicyclesnapshot:\n        var bicyclesnapshot = payload;\n        break;\n    default:\n}\n\nvar deviceType = 'sensor';\n\n// Result object with device attributes/telemetry data\nvar result = {\n    deviceName: deviceName,\n    deviceType: deviceType,\n    telemetry: {\n       car: car,\n       person: person,\n       bicycle: bicycle,\n       carsnapshot: carsnapshot,\n       personsnapshot: personsnapshot,\n       bicyclesnapshot: bicyclesnapshot\n   }\n};\n\n/** Helper functions **/\n\nfunction decodeToString(payload) {\n   return String.fromCharCode.apply(String, payload);\n}\n\nfunction decodeToJson(payload) {\n   // convert payload to string.\n   var str = decodeToString(payload);\n\n   // parse string to JSON\n   var data = JSON.parse(str);\n   return data;\n}\n\n\n\nreturn result;",
      "tbelDecoder" : "/** Decoder **/\n\n// decode payload to string\nvar data = decodeToString(payload);\nvar img = bytesToBase64(payload);\nvar json= decodeToJson(payload);\n// var decalration\nvar deviceName;\nvar deviceType = 'sensor';\nvar car;\nvar person;\nvar bicycle;\nvar carsnapshot;\nvar personsnapshot;\nvar bicyclesnapshot;\nvar zone_0;\nvar zone_1;\nvar zone_2;\nvar t;\nvar result;\n\nvar tempDevice=metadata.topic.split(\"/\")[1];\nif(tempDevice==\"events\"){\n    deviceName=json.before.camera;\n} else {\n    if(tempDevice==\"zone_0\" || tempDevice==\"zone_1\" || tempDevice==\"zone_2\"){\n        deviceName = \"market\";\n    }else{\n        deviceName = tempDevice;\n    }\n    car = null;\n    person = null;\n    bicycle = null;\n    carsnapshot = null;\n    personsnapshot = null;\n    bicyclesnapshot = null;\n    zone_0 = null;\n    zone_1 = null;\n    zone_2 = null;\n    t = metadata.topic;\n    \n    // pattern\n    var patterncar = 'frigate/'+deviceName+'/car';\n    var patternperson = 'frigate/'+deviceName+'/person';\n    var patternbicycle = 'frigate/'+deviceName+'/bicycle';\n    var patterncarsnapshot = 'frigate/'+deviceName+'/car/snapshot';\n    var patternpersonsnapshot = 'frigate/'+deviceName+'/person/snapshot';\n    var patternbicyclesnapshot = 'frigate/'+deviceName+'/bicycle/snapshot';\n    \n    if(t==patterncar){\n        car = data;\n    } else if(t==patternperson){\n        person = data;\n    } else if(t==patternbicycle){\n        bicycle = data;\n    } else if(t==patterncarsnapshot){\n        carsnapshot = img;\n    } else if(t==patternpersonsnapshot){\n        personsnapshot = img;\n    } else if(t==patternbicyclesnapshot){\n        bicyclesnapshot = img;\n    }\n    if(tempDevice==\"zone_0\"){\n            zone_0=data;\n    } else if(tempDevice==\"zone_1\"){\n        zone_1=data;\n    } else if(tempDevice==\"zone_2\"){\n        zone_2=data;\n    }\n}\n\nif(deviceName===\"restart\" || deviceName===\"events\" || deviceName==\"available\" || deviceName==\"stats\"){\n    result=null;\n} else {\n    result = {\n       deviceName: deviceName,\n       deviceType: deviceType,\n       telemetry: {\n           car: car,\n           person: person,\n           bicycle: bicycle,\n           carsnapshot: carsnapshot,\n           personsnapshot: personsnapshot,\n           bicyclesnapshot: bicyclesnapshot,\n           zone_0: zone_0,\n           zone_1: zone_1,\n           zone_2: zone_2,\n           \n           before_id: json.before.id,\n           before_frame_time: json.before.frame_time,\n           before_snapshot_time: json.before.snapshot_time,\n           before_label: json.before.label,\n           before_sub_label: json.before.sub_label,\n           before_top_score: json.before.top_score,\n           before_false_positive: json.before.false_positive,\n           before_start_time: json.before.start_time,\n           before_end_time: json.before.end_time,\n           before_score: json.before.score,\n           before_box: json.before.box,\n           before_area: json.before.area,\n           before_ratio: json.before.ratio,\n           before_region: json.before.region,\n           before_stationary: json.before.stationary,\n           before_motionless_count: json.before.motionless_count,\n           before_position_changes: json.before.position_changes,\n           before_current_zones: json.before.current_zones,\n           before_entered_zones: json.before.entered_zones,\n           before_has_clip: json.before.has_clip,\n           \n           after_id: json.after.id,\n           after_frame_time: json.after.frame_time,\n           after_snapshot_time: json.after.snapshot_time,\n           after_label: json.after.label,\n           after_sub_label: json.after.sub_label,\n           after_top_score: json.after.top_score,\n           after_false_positive: json.after.false_positive,\n           after_start_time: json.after.start_time,\n           after_end_time: json.after.end_time,\n           after_score: json.after.score,\n           after_box: json.after.box,\n           after_area: json.after.area,\n           after_ratio: json.after.ratio,\n           after_region: json.after.region,\n           after_stationary: json.after.stationary,\n           after_motionless_count: json.after.motionless_count,\n           after_position_changes: json.after.position_changes,\n           after_current_zones: json.after.current_zones,\n           after_entered_zones: json.after.entered_zones,\n           after_has_clip: json.after.has_clip\n       }\n    };\n}\n\n\n/** Helper functions **/\n\nfunction decodeToString(payload) {\n   return String.fromCharCode.apply(String, payload);\n}\n\nreturn result;",
      "encoder" : null,
      "tbelEncoder" : null
    },
    "debugMode" : true,
    "edgeTemplate" : false,
    "externalId" : null,
    "id" : {
      "entityType" : "CONVERTER",
      "id" : "038c4420-9816-11ed-a0f1-b51a14fb887c"
    },
    "name" : "Frigate",
    "type" : "UPLINK"
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}